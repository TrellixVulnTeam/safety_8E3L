{"ast":null,"code":"// mixin implementing the audit method\nconst AuditReport = require('../audit-report.js'); // shared with reify\n\n\nconst _global = Symbol.for('global');\n\nmodule.exports = cls => class Auditor extends cls {\n  async audit(options = {}) {\n    this.addTracker('audit');\n\n    if (this[_global]) {\n      throw Object.assign(new Error('`npm audit` does not support testing globals'), {\n        code: 'EAUDITGLOBAL'\n      });\n    } // allow the user to set options on the ctor as well.\n    // XXX: deprecate separate method options objects.\n\n\n    options = { ...this.options,\n      ...options\n    };\n    process.emit('time', 'audit');\n    const tree = await this.loadVirtual();\n    this.auditReport = await AuditReport.load(tree, this.options);\n    const ret = options.fix ? this.reify() : this.auditReport;\n    process.emit('timeEnd', 'audit');\n    this.finishTracker('audit');\n    return ret;\n  }\n\n};","map":{"version":3,"sources":["/Users/kaelen/nsc-mds/node_modules/npm/node_modules/@npmcli/arborist/lib/arborist/audit.js"],"names":["AuditReport","require","_global","Symbol","for","module","exports","cls","Auditor","audit","options","addTracker","Object","assign","Error","code","process","emit","tree","loadVirtual","auditReport","load","ret","fix","reify","finishTracker"],"mappings":"AAAA;AAEA,MAAMA,WAAW,GAAGC,OAAO,CAAC,oBAAD,CAA3B,C,CAEA;;;AACA,MAAMC,OAAO,GAAGC,MAAM,CAACC,GAAP,CAAW,QAAX,CAAhB;;AAEAC,MAAM,CAACC,OAAP,GAAiBC,GAAG,IAAI,MAAMC,OAAN,SAAsBD,GAAtB,CAA0B;AACrC,QAALE,KAAK,CAAEC,OAAO,GAAG,EAAZ,EAAgB;AACzB,SAAKC,UAAL,CAAgB,OAAhB;;AACA,QAAI,KAAKT,OAAL,CAAJ,EAAmB;AACjB,YAAMU,MAAM,CAACC,MAAP,CACJ,IAAIC,KAAJ,CAAU,8CAAV,CADI,EAEJ;AAAEC,QAAAA,IAAI,EAAE;AAAR,OAFI,CAAN;AAID,KAPwB,CASzB;AACA;;;AACAL,IAAAA,OAAO,GAAG,EAAE,GAAG,KAAKA,OAAV;AAAmB,SAAGA;AAAtB,KAAV;AAEAM,IAAAA,OAAO,CAACC,IAAR,CAAa,MAAb,EAAqB,OAArB;AACA,UAAMC,IAAI,GAAG,MAAM,KAAKC,WAAL,EAAnB;AACA,SAAKC,WAAL,GAAmB,MAAMpB,WAAW,CAACqB,IAAZ,CAAiBH,IAAjB,EAAuB,KAAKR,OAA5B,CAAzB;AACA,UAAMY,GAAG,GAAGZ,OAAO,CAACa,GAAR,GAAc,KAAKC,KAAL,EAAd,GAA6B,KAAKJ,WAA9C;AACAJ,IAAAA,OAAO,CAACC,IAAR,CAAa,SAAb,EAAwB,OAAxB;AACA,SAAKQ,aAAL,CAAmB,OAAnB;AACA,WAAOH,GAAP;AACD;;AArB+C,CAAlD","sourcesContent":["// mixin implementing the audit method\n\nconst AuditReport = require('../audit-report.js')\n\n// shared with reify\nconst _global = Symbol.for('global')\n\nmodule.exports = cls => class Auditor extends cls {\n  async audit (options = {}) {\n    this.addTracker('audit')\n    if (this[_global]) {\n      throw Object.assign(\n        new Error('`npm audit` does not support testing globals'),\n        { code: 'EAUDITGLOBAL' }\n      )\n    }\n\n    // allow the user to set options on the ctor as well.\n    // XXX: deprecate separate method options objects.\n    options = { ...this.options, ...options }\n\n    process.emit('time', 'audit')\n    const tree = await this.loadVirtual()\n    this.auditReport = await AuditReport.load(tree, this.options)\n    const ret = options.fix ? this.reify() : this.auditReport\n    process.emit('timeEnd', 'audit')\n    this.finishTracker('audit')\n    return ret\n  }\n}\n"]},"metadata":{},"sourceType":"script"}