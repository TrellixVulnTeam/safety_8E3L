{"ast":null,"code":"const pinflight = require('promise-inflight');\n\nconst spawn = require('./spawn.js');\n\nconst LRU = require('lru-cache');\n\nconst revsCache = new LRU({\n  max: 100,\n  maxAge: 5 * 60 * 1000\n});\n\nconst linesToRevs = require('./lines-to-revs.js');\n\nmodule.exports = (repo, opts = {}) => {\n  if (!opts.noGitRevCache) {\n    const cached = revsCache.get(repo);\n    if (cached) return Promise.resolve(cached);\n  }\n\n  return pinflight(`ls-remote:${repo}`, () => spawn(['ls-remote', repo], opts).then(({\n    stdout\n  }) => linesToRevs(stdout.trim().split('\\n'))).then(revs => (revsCache.set(repo, revs), revs)));\n};","map":{"version":3,"sources":["/Users/kaelen/nsc-mds/node_modules/npm/node_modules/@npmcli/git/lib/revs.js"],"names":["pinflight","require","spawn","LRU","revsCache","max","maxAge","linesToRevs","module","exports","repo","opts","noGitRevCache","cached","get","Promise","resolve","then","stdout","trim","split","revs","set"],"mappings":"AAAA,MAAMA,SAAS,GAAGC,OAAO,CAAC,kBAAD,CAAzB;;AACA,MAAMC,KAAK,GAAGD,OAAO,CAAC,YAAD,CAArB;;AACA,MAAME,GAAG,GAAGF,OAAO,CAAC,WAAD,CAAnB;;AAEA,MAAMG,SAAS,GAAG,IAAID,GAAJ,CAAQ;AACxBE,EAAAA,GAAG,EAAE,GADmB;AAExBC,EAAAA,MAAM,EAAE,IAAI,EAAJ,GAAS;AAFO,CAAR,CAAlB;;AAKA,MAAMC,WAAW,GAAGN,OAAO,CAAC,oBAAD,CAA3B;;AAEAO,MAAM,CAACC,OAAP,GAAiB,CAACC,IAAD,EAAOC,IAAI,GAAG,EAAd,KAAqB;AACpC,MAAI,CAACA,IAAI,CAACC,aAAV,EAAyB;AACvB,UAAMC,MAAM,GAAGT,SAAS,CAACU,GAAV,CAAcJ,IAAd,CAAf;AACA,QAAIG,MAAJ,EACE,OAAOE,OAAO,CAACC,OAAR,CAAgBH,MAAhB,CAAP;AACH;;AAED,SAAOb,SAAS,CAAE,aAAYU,IAAK,EAAnB,EAAsB,MACpCR,KAAK,CAAC,CAAC,WAAD,EAAcQ,IAAd,CAAD,EAAsBC,IAAtB,CAAL,CACCM,IADD,CACM,CAAC;AAACC,IAAAA;AAAD,GAAD,KAAcX,WAAW,CAACW,MAAM,CAACC,IAAP,GAAcC,KAAd,CAAoB,IAApB,CAAD,CAD/B,EAECH,IAFD,CAEMI,IAAI,KAAKjB,SAAS,CAACkB,GAAV,CAAcZ,IAAd,EAAoBW,IAApB,GAA2BA,IAAhC,CAFV,CADc,CAAhB;AAKD,CAZD","sourcesContent":["const pinflight = require('promise-inflight')\nconst spawn = require('./spawn.js')\nconst LRU = require('lru-cache')\n\nconst revsCache = new LRU({\n  max: 100,\n  maxAge: 5 * 60 * 1000,\n})\n\nconst linesToRevs = require('./lines-to-revs.js')\n\nmodule.exports = (repo, opts = {}) => {\n  if (!opts.noGitRevCache) {\n    const cached = revsCache.get(repo)\n    if (cached)\n      return Promise.resolve(cached)\n  }\n\n  return pinflight(`ls-remote:${repo}`, () =>\n    spawn(['ls-remote', repo], opts)\n    .then(({stdout}) => linesToRevs(stdout.trim().split('\\n')))\n    .then(revs => (revsCache.set(repo, revs), revs))\n  )\n}\n"]},"metadata":{},"sourceType":"script"}